import cv2
import numpy as np
from skimage.morphology import square, diamond
import matplotlib.pyplot as plt

def structuring_element_v4():
    return diamond(1).astype(np.uint8)

def structuring_element_v8():
    return square(3).astype(np.uint8)

def apply_morphology(image_path, element):
    image = cv2.imread(image_path, cv2.IMREAD_GRAYSCALE)
    morphed = cv2.morphologyEx(image, cv2.MORPH_CLOSE, element)
    return morphed

element_v4 = structuring_element_v4()
element_v8 = structuring_element_v8()

image_v4 = apply_morphology('/content/coins.bmp', element_v4)
image_v8 = apply_morphology('/content/coins.bmp', element_v8)

cv2.imwrite('/content/morphed_v4.png', image_v4)
cv2.imwrite('/content/morphed_v8.png', image_v8)

plt.figure(figsize=(10, 5))
plt.subplot(1, 2, 1)
plt.title("Morphed V4")
plt.imshow(image_v4, cmap='gray')
plt.axis('off')

plt.subplot(1, 2, 2)
plt.title("Morphed V8")
plt.imshow(image_v8, cmap='gray')
plt.axis('off')

plt.tight_layout()
plt.show()
